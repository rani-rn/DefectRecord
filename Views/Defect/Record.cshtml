@{
    ViewData["Title"] = "Record List";
}

<div class="container">
    <h2 class="text-header">Record</h2>
    <div class="row justify-content-center">
        <div class="col-md-10 col-lg-10">
            <input type="text" class="form-control mb-3" placeholder="Search...">
            <div class="table-responsive">
                <table class="table table-hover table-striped mb-0 table-responsive rounded-3 overflow-hidden">
                    <thead class="table-light rounded-top-3">
                        <tr class="text-center">
                            <th>No</th>
                            <th>Serial Number</th>
                            <th>Defect</th>
                            <th>Description</th>
                            <th>Status</th>
                            <th>Line Production</th>
                            <th>Report By</th>
                            <th>Role</th>
                            <th>Report Date</th>
                            <th>Action</th>
                        </tr>
                    </thead>

                    <tbody>
                        @{
                            int index = 1;
                        }
                        @foreach (var defect in Model)
                        {
                            <tr class="text-center">
                                <td>@index</td>
                                <td>@defect.SerialNumber</td>
                                <td>@defect.Defect?.DefectName</td>
                                <td>@defect.Description</td>
                                <td>@defect.Status</td>
                                <td>@defect.LineProduction?.LineProductionName</td>
                                <td>@defect.Reporter</td>
                                <td>@defect.Role?.RoleName</td>
                                <td>@defect.ReportDate</td>
                                <td>
                                    <a asp-controller="Defect" asp-action="Edit" class="btn btn-sm btn-warning">Edit</a>
                                    <button class="btn btn-sm btn-danger">Delete</button>
                                </td>
                            </tr>
                            index++;
                        }
                    </tbody>

                </table>
            </div>
        </div>
    </div>
</div>

<script>
    function confirmDelete(reportId) {
        Swal.fire({
            title: 'Are you sure?',
            text: "Do you want to delete this defect record?",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, delete it!'
        }).then((result) => {
            if (result.isConfirmed) {
                $.ajax({
                    url: '/Defect/Delete/' + reportId,
                    type: 'POST',
                    success: function () {
                        Swal.fire(
                            'Deleted!',
                            'Defect record deleted successfully.',
                            'success'
                        ).then(() => {
                            location.reload();
                        });
                    },
                    error: function () {
                        Swal.fire(
                            'Error!',
                            'There was a problem deleting the record. Please try again.',
                            'error'
                        );
                    }
                });
            }
        });
    }
</script>
